!function(n){function e(e){for(var r,o,c=e[0],u=e[1],s=e[2],l=0,p=[];l<c.length;l++)o=c[l],a[o]&&p.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(n[r]=u[r]);for(f&&f(e);p.length;)p.shift()();return i.push.apply(i,s||[]),t()}function t(){for(var n,e=0;e<i.length;e++){for(var t=i[e],r=!0,c=1;c<t.length;c++){var u=t[c];0!==a[u]&&(r=!1)}r&&(i.splice(e--,1),n=o(o.s=t[0]))}return n}var r={},a={0:0},i=[];function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=n,o.c=r,o.d=function(n,e,t){o.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},o.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},o.t=function(n,e){if(1&e&&(n=o(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var r in n)o.d(t,r,function(e){return n[e]}.bind(null,r));return t},o.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return o.d(e,"a",e),e},o.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},o.p="/";var c=window.webpackJsonp=window.webpackJsonp||[],u=c.push.bind(c);c.push=e,c=c.slice();for(var s=0;s<c.length;s++)e(c[s]);var f=u;i.push([102,1]),t()}({102:function(n,e,t){"use strict";t.r(e);t(63),t(45),t(48),t(52),t(79),t(17),t(60);var r=t(18),a=t.n(r),i=(t(91),t(1)),o=t.n(i),c=t(61),u=t.n(c),s=t(23),f=t.n(s),l=t(19),p=t.n(l),d=t(24),v=t.n(d),h=t(26),m=t.n(h),g=t(25),y=t.n(g),b=t(27),_=t.n(b),w=t(62),A=t.n(w),x=t(0);function O(){var n=o()([":host {\n        display: block;\n      }\n      .list-block {\n        display: grid;\n        grid-template-columns: repeat(3, .3333fr);\n        grid-gap: 5px;\n        font-size: 14px;\n      }\n      h3 {\n        margin: 10px 0;\n      }\n      h3 small {\n        color: #aaa;\n        font-weight: normal;\n        font-style: italic;\n      }\n      p {\n        margin: .25em 0;\n      }\n\n      .data-card {\n        padding: 10px 15px;\n        border: 1px solid #dedede;\n        border-radius: 5px;\n        background: rgba(255,255,255, .5);\n      }\n      .card-title-groups {\n        display: grid;\n        grid-template-columns: 1fr max-content;\n      }\n      .card-title-groups .summary-groups {\n        margin-top: 14px;\n      }\n      .card-body {\n        background: #f1f1f1;\n      }\n      .card-body > p:nth-child(even) {\n        background: #e5e5e5;\n      }\n\n      .data-item {\n        border-radius: 5px;\n        padding: 0 5px;\n        margin: 2px 3px;\n        box-shadow: 0 0 1px black;\n        display: inline-block;\n        background: #f6e09f;\n      }\n\n      .summary {\n        display: flex;\n        align-items: center;\n        color: #aaa;\n      }\n      .summary svg {\n        fill: #aaa;\n        width: 1.2em;\n        height: 1.2em;\n      }\n      .summary span {\n        margin: 0 8px 0 4px;\n      }\n      .summary-groups {\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .button {\n        width: 120px;\n        height: 40px;\n        background: orange;\n        color: #fff;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        text-decoration: none;\n        border-radius: 5px;\n      }"]);return O=function(){return n},n}function j(){var n=o()(['<span class="data-item">'," "," ","</span>"]);return j=function(){return n},n}function k(){var n=o()(['<span class="data-item">'," ","</span>"]);return k=function(){return n},n}function C(){var n=o()(['<span class="data-item">',"</span>"]);return C=function(){return n},n}function M(){var n=o()(['<div class="data-card"><div class="card-title-groups"><h3>',"<br><small>"," ","</small></h3><div>",'</div></div><div class="card-body">',"</div></div>"]);return M=function(){return n},n}function E(){var n=o()(['<div class="summary-groups"><div class="summary">','</div><div class="summary">','</div></div><div class="summary">',"</div>"]);return E=function(){return n},n}function H(){var n=o()(['<div class="summary">','</div><div class="summary">',"","</div>"]);return H=function(){return n},n}function V(){var n=o()(['<svg viewBox="0 0 24 24"><path d="M13,2V10H21A8,8 0 0,0 13,2M19.32,15.89C20.37,14.54 21,12.84 21,11H6.44L5.5,9H2V11H4.22C4.22,11 6.11,15.07 6.34,15.42C5.24,16 4.5,17.17 4.5,18.5A3.5,3.5 0 0,0 8,22C9.76,22 11.22,20.7 11.46,19H13.54C13.78,20.7 15.24,22 17,22A3.5,3.5 0 0,0 20.5,18.5C20.5,17.46 20.04,16.53 19.32,15.89M8,20A1.5,1.5 0 0,1 6.5,18.5A1.5,1.5 0 0,1 8,17A1.5,1.5 0 0,1 9.5,18.5A1.5,1.5 0 0,1 8,20M17,20A1.5,1.5 0 0,1 15.5,18.5A1.5,1.5 0 0,1 17,17A1.5,1.5 0 0,1 18.5,18.5A1.5,1.5 0 0,1 17,20Z"/></svg> <span>','</span> <svg viewBox="0 0 24 24"><path d="M9,9C10.29,9 11.5,9.41 12.47,10.11L17.58,5H13V3H21V11H19V6.41L13.89,11.5C14.59,12.5 15,13.7 15,15A6,6 0 0,1 9,21A6,6 0 0,1 3,15A6,6 0 0,1 9,9M9,11A4,4 0 0,0 5,15A4,4 0 0,0 9,19A4,4 0 0,0 13,15A4,4 0 0,0 9,11Z"/></svg> <span>','</span> <svg viewBox="0 0 24 24"><path d="M12,4A6,6 0 0,1 18,10C18,12.97 15.84,15.44 13,15.92V18H15V20H13V22H11V20H9V18H11V15.92C8.16,15.44 6,12.97 6,10A6,6 0 0,1 12,4M12,6A4,4 0 0,0 8,10A4,4 0 0,0 12,14A4,4 0 0,0 16,10A4,4 0 0,0 12,6Z"/></svg> <span>','</span> <svg viewBox="0 0 24 24"><path d="M11,18H13V16H11V18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6A4,4 0 0,0 8,10H10A2,2 0 0,1 12,8A2,2 0 0,1 14,10C14,12 11,11.75 11,15H13C13,12.75 16,12.5 16,10A4,4 0 0,0 12,6Z"/></svg> <span>',"</span>"]);return V=function(){return n},n}function D(){var n=o()(['<svg viewBox="0 0 24 24"><path fill="#555" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/></svg> <span style="color:#555;">',"</span>"]);return D=function(){return n},n}function I(){var n=o()(['<svg viewBox="0 0 24 24"><path fill="#555" d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z"/></svg> <span style="color:#555;">',"</span>"]);return I=function(){return n},n}function P(){var n=o()(['<a href="#" class="button" @click="','">API Data</a><p>種類總數： '," 種</p>",'<div class="list-block">',"</div>"]);return P=function(){return n},n}function S(){var n=o()(["",""]);return S=function(){return n},n}function R(){var n=o()(["<p><b>"," ","</b> ","</p>"]);return R=function(){return n},n}var B,L,Z,N,J=(B=Object,L=B.getPrototypeOf||function(n){return n.__proto__},Z=B.setPrototypeOf||function(n,e){return n.__proto__=e,n},N="object"===("undefined"==typeof Reflect?"undefined":a()(Reflect))?Reflect.construct:function(n,e,t){var r,a=[null];return a.push.apply(a,e),r=n.bind.apply(n,a),Z(new r,t.prototype)},function(n){var e=L(n);return Z(n,Z(function(){return N(e,arguments,L(this).constructor)},e))})(function(n){function e(){var n,t;f()(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=v()(this,(n=m()(e)).call.apply(n,[this].concat(a))),A()(y()(t),"_record",function(n){var e=y()(t)._behaviorChip,r=u()(n,2),a=r[0],i=r[1],o=a.type,c=a.detail;return Object(x.c)(R(),o,c,i.map(e))}),t}return _()(e,n),p()(e,[{key:"render",value:function(){var n=this,e=this.result;return Object(x.c)(S(),e&&e.length?Object(x.c)(P(),this.outputApiData,e.length,this._summaryOverview(e.see,e.hear),e.map(function(e){return n._listItem(e)})):"沒東西！")}},{key:"outputApiData",value:function(n){n.preventDefault();var e=[];this.result.forEach(function(n){var t=n.species,r=n.records,a={frog_id:t.id};r.forEach(function(n){var t=n[0],r=t.typeId,i=t.detailId;Object.assign(a,{habitat_id:r,habitat_p1_id:i}),n[1].forEach(function(n){var t=n.form,r=n.count,i=n.action;if("鳴"===t)r>=50?r=">50":r>=40?r="40-49":r>=30?r="30-39":r>=20?r="20-29":r>=10&&(r="10-19"),e.push(Object.assign({},a,{observing_method_id:1,amount:r,living_type_id:4,living_type_ids:4,behavior_id:2,behavior_ids:2,memo:null,_:Date.parse(new Date)}));else if("卵"===t||"蝌蚪"===t)e.push(Object.assign({},a,{observing_method_id:0,amount:"不計數",living_type_id:"卵"===t?1:2,living_type_ids:"卵"===t?1:2,behavior_id:0,behavior_ids:0,memo:null,_:Date.parse(new Date)}));else{var o=i.id;o<0&&(o=8),"幼"===t?t=3:"公"===t?t=4:"母"===t?t=5:"成"===t&&(t=6),e.push(Object.assign({},a,{observing_method_id:0,amount:r,living_type_id:t,living_type_ids:t,behavior_id:o,behavior_ids:o,memo:null,_:Date.parse(new Date)}))}})})}),console.log(JSON.stringify(e))}},{key:"_hear",value:function(n){return Object(x.c)(I(),n)}},{key:"_see",value:function(n){var e=n.froglet,t=n.male,r=n.female,a=n.grown;return Object(x.c)(D(),e+t+r+a)}},{key:"_seeDetail",value:function(n,e){var t=n.froglet,r=n.male,a=n.female,i=n.grown;return Object(x.c)(V(),t,r,a,i)}},{key:"_summaryOverview",value:function(n,e){return Object(x.c)(H(),this._hear(e),this._see(n),this._seeDetail(n))}},{key:"_summarySpecies",value:function(n,e){return Object(x.c)(E(),this._hear(e),this._see(n),this._seeDetail(n))}},{key:"_listItem",value:function(n){var e=this._record,t=n.species,r=n.records,a=n.summary,i=t.genus,o=t.species,c=t.abbr;return Object(x.c)(M(),c,i,o,this._summarySpecies(a.see,a.hear),r.map(e))}},{key:"_behaviorChip",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.form,t=n.count,r=n.action;return["卵","蝌蚪"].indexOf(e)>=0?Object(x.c)(C(),e):"鳴"===e?Object(x.c)(k(),e,t):Object(x.c)(j(),e,t,r.name)}}],[{key:"properties",get:function(){return{result:{type:Array}}}},{key:"styles",get:function(){return Object(x.b)(O())}}]),e}(x.a));function K(){var n=o()(["<p>","</p>"]);return K=function(){return n},n}function T(){var n=o()(["p {\n        background: #ffc107;\n        color: #555;\n        display: block;\n        padding: 2px 8px;\n        border-radius: 3px;\n      }"]);return T=function(){return n},n}function z(){var n=o()(["",""]);return z=function(){return n},n}customElements.define("investigation-list",J);var F=function(n){var e=n.getPrototypeOf||function(n){return n.__proto__},t=n.setPrototypeOf||function(n,e){return n.__proto__=e,n},r="object"===("undefined"==typeof Reflect?"undefined":a()(Reflect))?Reflect.construct:function(n,e,r){var a,i=[null];return i.push.apply(i,e),a=n.bind.apply(n,i),t(new a,r.prototype)};return function(n){var a=e(n);return t(n,t(function(){return r(a,arguments,e(this).constructor)},a))}}(Object)(function(n){function e(){var n;return f()(this,e),(n=v()(this,m()(e).call(this))).input=[],n}return _()(e,n),p()(e,[{key:"render",value:function(){var n=this.input;return Object(x.c)(z(),n.map(this._toast))}}],[{key:"properties",get:function(){return{input:{type:Array}}}},{key:"styles",get:function(){return Object(x.b)(T())}}]),p()(e,[{key:"_toast",value:function(n){return Object(x.c)(K(),n)}}]),e}(x.a));customElements.define("warning-toast",F);var q=t(13),G=t.n(q),Q=[["Bufonidae",[["Bufo",[["bankorensis",1,["盤古蟾蜍","盤古"]]]],["Duttaphrynus",[["melanostictus",2,["黑眶蟾蜍","黑眶","黑框"]]]]]],["Dicroglossidae",[["Fejervarya",[["cancrivora",22,["海蛙"]],["limnocharis",14,["澤蛙"]]]],["Hoplobatrachus",[["rugulosus",18,["虎皮蛙","虎皮","蛤蟆"]]]],["Limnonectes",[["fujianensis",12,["福建大頭蛙","大頭"]]]]]],["Hylidae",[["Hyla",[["chinensis",3,["中國樹蟾","樹蟾","中國"]]]]]],["Microhylidae",[["Kaloula",[["pulchra pulchra",8,["亞洲錦蛙","亞錦"]]]],["Microhyla",[["butleri",4,["巴氏小雨蛙","巴氏"]],["fissipes",6,["小雨蛙","小雨"]],["heymonsi",5,["黑蒙西氏小雨蛙","黑蒙"]]]],["Micryletta",[["steinegeri",7,["史丹吉氏小雨蛙","史丹","屎蛋"]]]]]],["Ranidae",[["Babina",[["adenopleura",9,["腹斑蛙","腹斑"]],["okinavana",17,["豎琴蛙","豎琴"]]]],["Hylarana",[["guentheri",11,["貢德氏赤蛙","貢德","狗蛙"]],["latoucii",13,["拉都希氏赤蛙","拉都"]],["taipehensis",21,["台北赤蛙","北赤"]]]],["Lithobates",[["catesbeianus",10,["美洲牛蛙","牛蛙","美牛"]]]],["Odorrana",[["swinhoana",20,["斯文豪氏赤蛙","斯文","鳥蛙"]]]],["Pelophylax",[["fukienensis",16,["金線蛙","金線"]]]],["Rana",[["longicrus",15,["長腳赤蛙","長腳"]],["sauteri",19,["梭德氏赤蛙","梭德"]]]]]],["Rhacophoridae",[["Buergeria",[["japonica",23,["日本樹蛙","日本"]],["otai",36,["太田樹蛙","太田"]],["robusta",24,["褐樹蛙","褐樹"]]]],["Kurixalus",[["berylliniris",34,["碧眼樹蛙","碧眼"]],["eiffingeri",25,["艾氏樹蛙","艾氏"]],["idiootocus",26,["面天樹蛙","面天"]],["wangi",35,["王氏樹蛙","王氏"]]]],["Polypedates",[["braueri",27,["布氏樹蛙","布氏"]],["megacephalus",33,["斑腿樹蛙","斑腿"]]]],["Rhacophorus",[["arvalis",28,["諸羅樹蛙","諸羅"]],["aurantiventris",29,["橙腹樹蛙","橙腹"]],["moltrechti",30,["莫氏樹蛙","莫氏"]],["prasinatus",31,["翡翠樹蛙","翡翠"]],["taipeianus",32,["台北樹蛙","北樹"]]]]]]],U=[];Q.forEach(function(n){return n[1].forEach(function(n){return n[1].forEach(function(n){return U.push.apply(U,G()(n[2]))})})});var W=[[1,"流動水域",[[1,1,"< 5m",["流水"]],[2,2,"> 5m",["溪流"]],[3,3,"山澗瀑布",["山澗瀑布","瀑布"]]]],[8,"永靜水域",[[28,4,"水域",["水域"]],[29,5,"岸邊",["水岸"]],[30,6,"植物",["水植"]]]],[9,"暫靜水域",[[31,7,"水域",["暫水域","暫水"]],[32,8,"岸邊",["暫水岸"]],[33,9,"植物",["暫水植"]],[44,10,"植物積水",["植水"]]]],[10,"樹木",[[34,11,"喬木",["喬木","樹林"]],[35,12,"灌木",["灌木"]],[36,13,"底層",["底層"]],[37,14,"竹子",["竹子","竹林"]]]],[6,"草地",[[16,15,"短草",["短草"]],[17,16,"高草",["高草","長草"]]]],[11,"人造區域",[[45,17,"邊坡",["邊坡"]],[38,18,"乾溝",["乾溝"]],[39,19,"建物",["建物"]],[40,20,"車道",["車道"]],[41,21,"步道",["步道"]],[42,22,"空地",["空地"]]]],[12,"其他",[[43,23,"其他",["其他"]]]]],X=[];W.forEach(function(n){return n[2].forEach(function(n){return X.push.apply(X,["@".concat(n[1])].concat(G()(n[3])))})});t(99),t(100);var Y=[[0,["無"]],[1,["聚集","聚"]],[2,["鳴叫","鳴"]],[3,["築巢"]],[4,["領域"]],[5,["配對","抱接"]],[6,["打架"]],[7,["護幼"]],[8,["單獨"]],[9,["覓食"]],[10,["休息"]],[11,["屍體","屍"]],[12,["畸形蛙","畸形"]],[13,["病蛙"]]],nn=[];Y.forEach(function(n){return nn.push.apply(nn,["#".concat(n[0]+1)].concat(G()(n[1])))});var en=new RegExp("(抱接|鳴|幼|公|母|成|蝌蚪|卵\\S?)(\\d+)(".concat(nn.join("|"),")?(:\\S+)?"));function tn(n,e,t){if(n&&e.length){var r=t.find(function(e){var t=e.species,r=t.genus,a=t.species,i=n.genus,o=n.species;return"".concat(r," ").concat(a)==="".concat(i," ").concat(o)});r?rn(r.records,e):t.push({species:n,records:e})}}function rn(n,e){e.forEach(function(e){var t=n.find(function(n){return n[0].detailId===e[0].detailId});t?e[1].forEach(function(n){return an(t[1],[n])}):n.push(e)})}function an(n,e){e.forEach(function(e){var t=n.find(function(n){return n.form===e.form&&n.action===e.action});t?"number"==typeof t.count&&(t.count+=e.count):n.push(e)})}var on=[],cn=function(n){var e=[],t="",r=[],a=[];n.split(/\r?\n/).forEach(function(n,i){if(n=n.trim()){var o=0,c=0;n.split(/\s/).forEach(function(n,u){if(!n)return c+=1,void(u===o&&(o+=1));var s=U.indexOf(n)>=0;if(u===o&&0===i&&!s)throw on.push("Should started with a species name."),new Error("Should started with a species name.");if(s){if(r.length&&(tn(t,r,e),t=null,r=[],a=[]),Q.find(function(e){return e[1].find(function(r){return r[1].find(function(a){return a[2].find(function(i){if(i===n)return t={family:e[0],genus:r[0],species:a[0],abbr:a[2][0],id:a[1]},!0})})})}),!t)throw on.push("".concat(i+1,":").concat(c," is an undefined species: ").concat(n,".")),new Error("".concat(i+1,":").concat(c," is an undefined species: ").concat(n,"."))}else if(X.indexOf(n)>=0){var f;if("@"===n[0]){var l=Number(n.substring(1));W.find(function(n){return n[2].find(function(e){if(e[1]===l)return f={type:n[1],typeId:n[0],detail:e[2],detailId:e[0]},!0})})}else W.find(function(e){return e[2].find(function(t){return t[3].find(function(r){if(r===n)return f={type:e[1],typeId:e[0],detail:t[2],detailId:t[0]},!0})})});if(!f)throw on.push("".concat(i+1,":").concat(c," is an undefined habitat: ").concat(n,".")),new Error("".concat(i+1,":").concat(c," is an undefined habitat: ").concat(n,"."));rn(r,[[f,a]]),a=[]}else{var p=function(n){var e=n.match(en);if(!e)return console.warn("看不懂："+n),null;if("蝌蚪"===e[1]||"卵"===e[1][0])return[{form:e[1]}];var t=Number(e[2]);if("抱接"===e[1])return[{form:"公",count:t,action:{id:5,name:"配對"}},{form:"母",count:t,action:{id:5,name:"配對"}}];var r=e[3];if(r){var a;if("#"===r[0]){var i=Number(r.substring(1))-1;a=Y.find(function(n){return n[0]===i})}else a=Y.find(function(n){return n[1].find(function(n){return n===r})});if(!a)return console.warn("找不到行為"),null;r={id:a[0],name:a[1][0]}}else r={id:8,name:"單獨"};return[{form:e[1],count:t,action:r}]}(n);p?an(a,p):(on.push("".concat(i+1,":").concat(c," is an undefined data: ").concat(n)),console.warn("".concat(i+1,":").concat(c," is an undefined data: ").concat(n)))}c+=n.length+1})}else console.log("line ".concat(i+1," is an empty line."))}),r.length&&(tn(t,r,e),r=[],a=[]);var i={froglet:0,male:0,female:0,grown:0};return e.see=Object.assign({},i),e.hear=0,e.forEach(function(n){n.records.sort(function(n,e){return n[0].typeId-e[0].typeId||n[0].detailId-e[0].detailId});var t,r,a=Object.assign({},i),o=0;n.records.forEach(function(n){n[1].forEach(function(n){var e=n.form,t=n.count;switch(e){case"幼":a.froglet+=t;break;case"公":a.male+=t;break;case"母":a.female+=t;break;case"成":a.grown+=t;break;case"鳴":o+=t}})}),n.summary={see:a,hear:o},e.hear+=o,t=e.see,r=a,t.froglet+=r.froglet,t.male+=r.male,t.female+=r.female,t.grown+=r.grown}),console.log(e),e.sort(function(n,e){var t=n.species,r=e.species;return"".concat(t.family," ").concat(t.genus," ").concat(t.species).localeCompare("".concat(r.family," ").concat(r.genus," ").concat(r.species))})};$(function(){var n=$("#raw-text"),e=$("investigation-list")[0];$("button").click(function(t){t.preventDefault();try{e.result=cn($.trim(n.val()))}catch(t){console.warn(t),e.result=[]}finally{$("warning-toast")[0].input=on,on=[]}})})}});