!function(n){function e(e){for(var r,o,c=e[0],s=e[1],u=e[2],f=0,d=[];f<c.length;f++)o=c[f],i[o]&&d.push(i[o][0]),i[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(n[r]=s[r]);for(l&&l(e);d.length;)d.shift()();return a.push.apply(a,u||[]),t()}function t(){for(var n,e=0;e<a.length;e++){for(var t=a[e],r=!0,c=1;c<t.length;c++){var s=t[c];0!==i[s]&&(r=!1)}r&&(a.splice(e--,1),n=o(o.s=t[0]))}return n}var r={},i={0:0},a=[];function o(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=n,o.c=r,o.d=function(n,e,t){o.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},o.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},o.t=function(n,e){if(1&e&&(n=o(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var r in n)o.d(t,r,function(e){return n[e]}.bind(null,r));return t},o.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return o.d(e,"a",e),e},o.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},o.p="/g.amphibian-investigation.pwa/";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=s;a.push([98,1]),t()}({98:function(n,e,t){"use strict";t.r(e);var r=t(61);Object(r.a)("./service-worker.js",{registrationOptions:{scope:"./"},ready:function(n){console.log("Service worker is active.")},registered:function(n){console.log("Service worker has been registered.")},cached:function(n){console.log("Content has been cached for offline use.")},updatefound:function(n){console.log("New content is downloading.")},updated:function(n){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(n){console.error("Error during service worker registration:",n)}});t(41);var i=t(14),a=t.n(i),o=(t(72),t(40)),c=t.n(o),s=(t(35),t(49),t(62)),u=t.n(s),l=t(1),f=t.n(l),d=t(20),p=t.n(d),h=t(21),v=t.n(h),m=t(15),g=t.n(m),y=t(22),b=t.n(y),w=t(24),_=t.n(w),x=t(23),k=t.n(x),O=t(25),A=t.n(O),j=t(63),C=t.n(j),E=t(0);function M(){var n=f()([':host {\n        display: block;\n      }\n      .list-block {\n        display: grid;\n        grid-template-columns: repeat(3, .3333fr);\n        grid-gap: 10px;\n        font-size: 14px;\n      }\n\n      @media only screen and (max-width:800px) {\n        .list-block {\n          grid-template-columns: repeat(2, .5fr);\n          grid-gap: 12px\n        }\n      }\n\n      @media only screen and (max-width:540px) {\n        .list-block {\n          grid-template-columns: 1fr;\n        }\n      }\n\n      h3 {\n        margin: 10px 0;\n      }\n\n      p {\n        margin: .25em 0;\n      }\n\n      .data-card {\n        padding: 10px 15px;\n        border: 1px solid #dedede;\n        border-radius: 5px;\n        background: rgba(255,255,255, .5);\n      }\n      .card-title-groups {\n        display: grid;\n        grid-template-columns: 1fr max-content;\n        grid-template-rows: .5fr .5fr;\n        grid-template-areas: "commonname statistics" "sciencename statistics";\n      }\n      .card-title-groups > h3 {\n        grid-area: commonname;\n        margin-bottom: 0;\n      }\n      .card-title-groups > small {\n        grid-area: sciencename;\n        color: #aaa;\n        font-weight: normal;\n        font-style: italic;\n        margin-bottom: 10px;\n      }\n      .card-title-groups > div {\n        grid-area: statistics;\n      }\n      .card-title-groups .summary-groups {\n        margin-top: 14px;\n      }\n      .card-body {\n        background: #f1f1f1;\n      }\n      .card-body > p:nth-child(even) {\n        background: #e5e5e5;\n      }\n\n      .data-item {\n        border-radius: 5px;\n        padding: 0 5px;\n        margin: 2px 3px;\n        box-shadow: 0 0 1px black;\n        display: inline-block;\n        background: #f6e09f;\n      }\n\n      .summary {\n        display: flex;\n        align-items: center;\n        color: #aaa;\n      }\n      .summary svg {\n        fill: #aaa;\n        width: 1.2em;\n        height: 1.2em;\n      }\n      .summary span {\n        margin: 0 8px 0 4px;\n      }\n      .summary-groups {\n        display: flex;\n        justify-content: space-between;\n      }\n\n      .button {\n        width: 120px;\n        height: 40px;\n        background: orange;\n        color: #fff;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        text-decoration: none;\n        border-radius: 5px;\n      }']);return M=function(){return n},n}function H(){var n=f()(['<span class="data-item">'," "," ","</span>"]);return H=function(){return n},n}function I(){var n=f()(['<span class="data-item">'," ","</span>"]);return I=function(){return n},n}function S(){var n=f()(['<span class="data-item">',"</span>"]);return S=function(){return n},n}function V(){var n=f()(['<div class="data-card"><div class="card-title-groups"><h3>',"<br></h3><small>"," ","</small><div>",'</div></div><div class="card-body">',"</div></div>"]);return V=function(){return n},n}function D(){var n=f()(['<div class="summary-groups"><div class="summary">','</div><div class="summary">','</div></div><div class="summary">',"</div>"]);return D=function(){return n},n}function P(){var n=f()(['<div class="summary">','</div><div class="summary">',"","</div>"]);return P=function(){return n},n}function R(){var n=f()(['<svg viewBox="0 0 24 24"><path d="M13,2V10H21A8,8 0 0,0 13,2M19.32,15.89C20.37,14.54 21,12.84 21,11H6.44L5.5,9H2V11H4.22C4.22,11 6.11,15.07 6.34,15.42C5.24,16 4.5,17.17 4.5,18.5A3.5,3.5 0 0,0 8,22C9.76,22 11.22,20.7 11.46,19H13.54C13.78,20.7 15.24,22 17,22A3.5,3.5 0 0,0 20.5,18.5C20.5,17.46 20.04,16.53 19.32,15.89M8,20A1.5,1.5 0 0,1 6.5,18.5A1.5,1.5 0 0,1 8,17A1.5,1.5 0 0,1 9.5,18.5A1.5,1.5 0 0,1 8,20M17,20A1.5,1.5 0 0,1 15.5,18.5A1.5,1.5 0 0,1 17,17A1.5,1.5 0 0,1 18.5,18.5A1.5,1.5 0 0,1 17,20Z"/></svg> <span>','</span> <svg viewBox="0 0 24 24"><path d="M9,9C10.29,9 11.5,9.41 12.47,10.11L17.58,5H13V3H21V11H19V6.41L13.89,11.5C14.59,12.5 15,13.7 15,15A6,6 0 0,1 9,21A6,6 0 0,1 3,15A6,6 0 0,1 9,9M9,11A4,4 0 0,0 5,15A4,4 0 0,0 9,19A4,4 0 0,0 13,15A4,4 0 0,0 9,11Z"/></svg> <span>','</span> <svg viewBox="0 0 24 24"><path d="M12,4A6,6 0 0,1 18,10C18,12.97 15.84,15.44 13,15.92V18H15V20H13V22H11V20H9V18H11V15.92C8.16,15.44 6,12.97 6,10A6,6 0 0,1 12,4M12,6A4,4 0 0,0 8,10A4,4 0 0,0 12,14A4,4 0 0,0 16,10A4,4 0 0,0 12,6Z"/></svg> <span>','</span> <svg viewBox="0 0 24 24"><path d="M11,18H13V16H11V18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6A4,4 0 0,0 8,10H10A2,2 0 0,1 12,8A2,2 0 0,1 14,10C14,12 11,11.75 11,15H13C13,12.75 16,12.5 16,10A4,4 0 0,0 12,6Z"/></svg> <span>',"</span>"]);return R=function(){return n},n}function B(){var n=f()(['<svg viewBox="0 0 24 24"><path fill="#555" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"/></svg> <span style="color:#555;">',"</span>"]);return B=function(){return n},n}function N(){var n=f()(['<svg viewBox="0 0 24 24"><path fill="#555" d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z"/></svg> <span style="color:#555;">',"</span>"]);return N=function(){return n},n}function L(){var n=f()(['<a href="#" class="button" @click="','">複製API資料</a> <small>API資料複製：',"</small><p>種類總數： "," 種</p>",'<div class="list-block">',"</div>"]);return L=function(){return n},n}function Z(){var n=f()(["",""]);return Z=function(){return n},n}function J(){var n=f()(["<p><b>"," ","</b> ","</p>"]);return J=function(){return n},n}var T,K,z,F,q=(T=Object,K=T.getPrototypeOf||function(n){return n.__proto__},z=T.setPrototypeOf||function(n,e){return n.__proto__=e,n},F="object"===("undefined"==typeof Reflect?"undefined":a()(Reflect))?Reflect.construct:function(n,e,t){var r,i=[null];return i.push.apply(i,e),r=n.bind.apply(n,i),z(new r,t.prototype)},function(n){var e=K(n);return z(n,z(function(){return F(e,arguments,K(this).constructor)},e))})(function(n){function e(){var n,t;v()(this,e);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return t=b()(this,(n=_()(e)).call.apply(n,[this].concat(i))),C()(k()(t),"_record",function(n){var e=k()(t)._behaviorChip,r=p()(n,2),i=r[0],a=r[1],o=i.type,c=i.detail;return Object(E.c)(J(),o,c,a.map(e))}),t}return A()(e,n),g()(e,[{key:"render",value:function(){var n=this,e=this.result;return Object(E.c)(Z(),e&&e.length?Object(E.c)(L(),this.outputApiData,this.copytime||"-",e.length,this._summaryOverview(e.see,e.hear),e.map(function(e){return n._listItem(e)})):"沒東西！")}},{key:"outputApiData",value:function(){var n=u()(c.a.mark(function n(e){var t,r=this;return c.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:e.preventDefault(),t=[],this.result.forEach(function(n){var e=n.species,r=n.records,i={frog_id:e.id};r.forEach(function(n){var e=n[0],r=e.typeId,a=e.detailId;Object.assign(i,{habitat_id:r,habitat_p1_id:a}),n[1].forEach(function(n){var e=n.form,r=n.count,a=n.action;if("鳴"===e)r>=50?r=">50":r>=40?r="40-49":r>=30?r="30-39":r>=20?r="20-29":r>=10&&(r="10-19"),t.push(Object.assign({},i,{observing_method_id:1,amount:r,living_type_id:4,living_type_ids:4,behavior_id:2,behavior_ids:2,memo:null,_:Date.parse(new Date)}));else if("卵"===e||"蝌蚪"===e)t.push(Object.assign({},i,{observing_method_id:0,amount:"不計數",living_type_id:"卵"===e?1:2,living_type_ids:"卵"===e?1:2,behavior_id:0,behavior_ids:0,memo:null,_:Date.parse(new Date)}));else{var o=a.id;o<0&&(o=8),"幼"===e?e=3:"公"===e?e=4:"母"===e?e=5:"成"===e&&(e=8),t.push(Object.assign({},i,{observing_method_id:0,amount:r,living_type_id:e,living_type_ids:e,behavior_id:o,behavior_ids:o,memo:null,_:Date.parse(new Date)}))}})})}),navigator.clipboard.writeText(JSON.stringify(t)).then(function(n){r.copytime=(new Date).toLocaleString(),console.log("資料已複製!")}).catch(function(n){return console.warn("無法複製",n)});case 4:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()},{key:"_hear",value:function(n){return Object(E.c)(N(),n)}},{key:"_see",value:function(n){var e=n.froglet,t=n.male,r=n.female,i=n.grown;return Object(E.c)(B(),e+t+r+i)}},{key:"_seeDetail",value:function(n,e){var t=n.froglet,r=n.male,i=n.female,a=n.grown;return Object(E.c)(R(),t,r,i,a)}},{key:"_summaryOverview",value:function(n,e){return Object(E.c)(P(),this._hear(e),this._see(n),this._seeDetail(n))}},{key:"_summarySpecies",value:function(n,e){return Object(E.c)(D(),this._hear(e),this._see(n),this._seeDetail(n))}},{key:"_listItem",value:function(n){var e=this._record,t=n.species,r=n.records,i=n.summary,a=t.genus,o=t.species,c=t.abbr;return Object(E.c)(V(),c,a,o,this._summarySpecies(i.see,i.hear),r.map(e))}},{key:"_behaviorChip",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.form,t=n.count,r=n.action;return["卵","蝌蚪"].indexOf(e)>=0?Object(E.c)(S(),e):"鳴"===e?Object(E.c)(I(),e,t):Object(E.c)(H(),e,t,r.name)}}],[{key:"properties",get:function(){return{result:{type:Array},copytime:{type:String}}}},{key:"styles",get:function(){return Object(E.b)(M())}}]),e}(E.a));function G(){var n=f()(["<p>","</p>"]);return G=function(){return n},n}function Q(){var n=f()([":host {\n        max-height: 200px;\n        overflow: auto;\n        display: block;\n      }\n      p {\n        background: #ffc107;\n        color: #555;\n        display: block;\n        padding: 2px 8px;\n        border-radius: 3px;\n      }"]);return Q=function(){return n},n}function U(){var n=f()(["",""]);return U=function(){return n},n}customElements.define("investigation-list",q);var W=function(n){var e=n.getPrototypeOf||function(n){return n.__proto__},t=n.setPrototypeOf||function(n,e){return n.__proto__=e,n},r="object"===("undefined"==typeof Reflect?"undefined":a()(Reflect))?Reflect.construct:function(n,e,r){var i,a=[null];return a.push.apply(a,e),i=n.bind.apply(n,a),t(new i,r.prototype)};return function(n){var i=e(n);return t(n,t(function(){return r(i,arguments,e(this).constructor)},i))}}(Object)(function(n){function e(){var n;return v()(this,e),(n=b()(this,_()(e).call(this))).input=[],n}return A()(e,n),g()(e,[{key:"render",value:function(){var n=this.input;return Object(E.c)(U(),n.map(this._toast))}}],[{key:"properties",get:function(){return{input:{type:Array}}}},{key:"styles",get:function(){return Object(E.b)(Q())}}]),g()(e,[{key:"_toast",value:function(n){return Object(E.c)(G(),n)}}]),e}(E.a));customElements.define("warning-toast",W);t(51),t(37),t(38),t(55);var X=t(10),Y=t.n(X),nn=[["Bufonidae",[["Bufo",[["bankorensis",1,["盤古蟾蜍","盤古"]]]],["Duttaphrynus",[["melanostictus",2,["黑眶蟾蜍","黑眶","黑框"]]]]]],["Dicroglossidae",[["Fejervarya",[["cancrivora",22,["海蛙"]],["limnocharis",14,["澤蛙"]]]],["Hoplobatrachus",[["rugulosus",18,["虎皮蛙","虎皮","蛤蟆"]]]],["Limnonectes",[["fujianensis",12,["福建大頭蛙","大頭"]]]]]],["Hylidae",[["Hyla",[["chinensis",3,["中國樹蟾","樹蟾","中國"]]]]]],["Microhylidae",[["Kaloula",[["pulchra pulchra",8,["亞洲錦蛙","亞錦"]]]],["Microhyla",[["butleri",4,["巴氏小雨蛙","巴氏"]],["fissipes",6,["小雨蛙","小雨"]],["heymonsi",5,["黑蒙西氏小雨蛙","黑蒙"]]]],["Micryletta",[["steinegeri",7,["史丹吉氏小雨蛙","史丹","屎蛋"]]]]]],["Ranidae",[["Babina",[["adenopleura",9,["腹斑蛙","腹斑"]],["okinavana",17,["豎琴蛙","豎琴"]]]],["Hylarana",[["guentheri",11,["貢德氏赤蛙","貢德","狗蛙"]],["latoucii",13,["拉都希氏赤蛙","拉都"]],["taipehensis",21,["台北赤蛙","北赤"]]]],["Lithobates",[["catesbeianus",10,["美洲牛蛙","牛蛙","美牛"]]]],["Odorrana",[["swinhoana",20,["斯文豪氏赤蛙","斯文","鳥蛙"]]]],["Pelophylax",[["fukienensis",16,["金線蛙","金線"]]]],["Rana",[["longicrus",15,["長腳赤蛙","長腳"]],["sauteri",19,["梭德氏赤蛙","梭德"]]]]]],["Rhacophoridae",[["Buergeria",[["japonica",23,["日本樹蛙","日本"]],["otai",36,["太田樹蛙","太田"]],["robusta",24,["褐樹蛙","褐樹"]]]],["Kurixalus",[["berylliniris",34,["碧眼樹蛙","碧眼"]],["eiffingeri",25,["艾氏樹蛙","艾氏"]],["idiootocus",26,["面天樹蛙","面天"]],["wangi",35,["王氏樹蛙","王氏"]]]],["Polypedates",[["braueri",27,["布氏樹蛙","布氏"]],["megacephalus",33,["斑腿樹蛙","斑腿"]]]],["Rhacophorus",[["arvalis",28,["諸羅樹蛙","諸羅"]],["aurantiventris",29,["橙腹樹蛙","橙腹"]],["moltrechti",30,["莫氏樹蛙","莫氏"]],["prasinatus",31,["翡翠樹蛙","翡翠"]],["taipeianus",32,["台北樹蛙","北樹"]]]]]]],en=[];nn.forEach(function(n){return n[1].forEach(function(n){return n[1].forEach(function(n){return en.push.apply(en,Y()(n[2]))})})});var tn=[[1,"流動水域",[[1,1,"< 5m",["流水"]],[2,2,"> 5m",["溪流"]],[3,3,"山澗瀑布",["山澗瀑布","瀑布"]]]],[8,"永靜水域",[[28,4,"水域",["水域"]],[29,5,"岸邊",["水岸"]],[30,6,"植物",["水植"]]]],[9,"暫靜水域",[[31,7,"水域",["暫水域","暫水"]],[32,8,"岸邊",["暫水岸"]],[33,9,"植物",["暫水植"]],[44,10,"植物積水",["植水"]]]],[10,"樹木",[[34,11,"喬木",["喬木","樹林"]],[35,12,"灌木",["灌木"]],[36,13,"底層",["底層"]],[37,14,"竹子",["竹子","竹林"]]]],[6,"草地",[[16,15,"短草",["短草"]],[17,16,"高草",["高草","長草"]]]],[11,"人造區域",[[45,17,"邊坡",["邊坡"]],[38,18,"乾溝",["乾溝"]],[39,19,"建物",["建物"]],[40,20,"車道",["車道"]],[41,21,"步道",["步道"]],[42,22,"空地",["空地"]]]],[12,"其他",[[43,23,"其他",["其他"]]]]],rn=[];tn.forEach(function(n){return n[2].forEach(function(n){return rn.push.apply(rn,["@".concat(n[1])].concat(Y()(n[3])))})});var an=[[0,["無"]],[1,["聚集","聚"]],[2,["鳴叫","鳴"]],[3,["築巢"]],[4,["領域"]],[5,["配對","抱接"]],[6,["打架"]],[7,["護幼"]],[8,["單獨"]],[9,["覓食"]],[10,["休息"]],[11,["屍體","屍"]],[12,["畸形蛙","畸形"]],[13,["病蛙"]]],on=[];an.forEach(function(n){return on.push.apply(on,["#".concat(n[0]+1)].concat(Y()(n[1])))});t(95),t(96);var cn=new RegExp("(抱接|鳴|幼|公|母|成|蝌蚪|卵\\S?)(\\d+)?(\\S+)?(:\\S+)?");function sn(n,e,t){if(n&&e.length){var r=t.find(function(e){var t=e.species,r=t.genus,i=t.species,a=n.genus,o=n.species;return"".concat(r," ").concat(i)==="".concat(a," ").concat(o)});r?un(r.records,e):t.push({species:n,records:e})}}function un(n,e){e.forEach(function(e){var t=n.find(function(n){return n[0].detailId===e[0].detailId});t?ln(t[1],e[1]):n.push(e)})}function ln(n,e){e.forEach(function(e){var t=n.find(function(n){return n.form===e.form&&n.action.id===e.action.id});t?t.count+=e.count:n.push(e)})}function fn(n,e){n.froglet+=e.froglet,n.male+=e.male,n.female+=e.female,n.grown+=e.grown}function dn(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=[],r="",i=[];n.split(/\r?\n/).forEach(function(n,a){if(n=n.trim()){var o=0,c=0;n.split(/\s/).forEach(function(n,s){if(!n)return c+=1,void(s===o&&(o+=1));var u=en.indexOf(n)>=0;if(s===o&&0===a&&!u)throw e.push("Should started with a species name."),new Error("Should started with a species name.");if(u){if(i.length&&(sn(r,i,t),r=null,i=[]),nn.find(function(e){return e[1].find(function(t){return t[1].find(function(i){return i[2].find(function(a){if(a===n)return r={family:e[0],genus:t[0],species:i[0],abbr:i[2][0],id:i[1]},!0})})})}),!r)throw e.push("".concat(a+1,":").concat(c," is an undefined species: ").concat(n,".")),new Error("".concat(a+1,":").concat(c," is an undefined species: ").concat(n,"."))}else{var l=function(n){var e=n.trim().split(".");if(e.length<1)return console.warn("empty line!"),null;var t=e.map(function(n){return(n||"").trim()}),r=p()(t,5),i=r[0],a=r[1],o=r[2],c=r[3],s=r[4];switch(i=["","卵","蝌蚪","幼","公","母","成","鳴"][i],o=Number(o),c){case"目3":c="3";break;case"3":i="鳴";break;case void 0:c=9}"蝌蚪"!==i&&"卵"!==i||(c=0);var u=an.find(function(n){return n[0]===Number(c)-1});if(!u)return console.warn("看不懂這個行為代號"),null;var l={id:u[0],name:u[1][0]};return tn.find(function(n){return n[2].find(function(e){if(e[1]===Number(a))return a={type:n[1],typeId:n[0],detail:e[2],detailId:e[0]},!0})}),a&&a.detailId?[a,[{form:i,count:o,action:l,note:s}]]:(console.warn("看不懂這個棲地代號"),null)}(n);l?un(i,[l]):(e.push("".concat(a+1,":").concat(c," is an undefined data: ").concat(n)),console.warn("".concat(a+1,":").concat(c," is an undefined data: ").concat(n)))}c+=n.length+1})}else console.log("line ".concat(a+1," is an empty line."))}),i.length&&(sn(r,i,t),i=[]);var a={froglet:0,male:0,female:0,grown:0};return t.see=Object.assign({},a),t.hear=0,t.forEach(function(n){n.records.sort(function(n,e){return n[0].typeId-e[0].typeId||n[0].detailId-e[0].detailId});var e=Object.assign({},a),r=0;n.records.forEach(function(n){n[1].forEach(function(n){var t=n.form,i=n.count;switch(t){case"幼":e.froglet+=i;break;case"公":e.male+=i;break;case"母":e.female+=i;break;case"成":e.grown+=i;break;case"鳴":r+=i}})}),n.summary={see:e,hear:r},t.hear+=r,fn(t.see,e)}),console.log(t),t.sort(function(n,e){var t=n.species,r=e.species;return"".concat(t.family," ").concat(t.genus," ").concat(t.species).localeCompare("".concat(r.family," ").concat(r.genus," ").concat(r.species))})}function pn(n,e){var t=[],r="",i=[],a=[];n.split(/\r?\n/).forEach(function(n,o){if(n=n.trim()){var c=0,s=0;n.split(/\s/).forEach(function(n,u){if(!n)return s+=1,void(u===c&&(c+=1));var l=en.indexOf(n)>=0;if(u===c&&0===o&&!l)throw e.push("Should started with a species name."),new Error("Should started with a species name.");if(l){if(i.length&&(sn(r,i,t),r=null,i=[],a=[]),nn.find(function(e){return e[1].find(function(t){return t[1].find(function(i){return i[2].find(function(a){if(a===n)return r={family:e[0],genus:t[0],species:i[0],abbr:i[2][0],id:i[1]},!0})})})}),!r)throw e.push("".concat(o+1,":").concat(s," is an undefined species: ").concat(n,".")),new Error("".concat(o+1,":").concat(s," is an undefined species: ").concat(n,"."))}else if(rn.indexOf(n)>=0){var f;if("@"===n[0]){var d=Number(n.substring(1));tn.find(function(n){return n[2].find(function(e){if(e[1]===d)return f={type:n[1],typeId:n[0],detail:e[2],detailId:e[0]},!0})})}else tn.find(function(e){return e[2].find(function(t){return t[3].find(function(r){if(r===n)return f={type:e[1],typeId:e[0],detail:t[2],detailId:t[0]},!0})})});if(!f)throw e.push("".concat(o+1,":").concat(s," is an undefined habitat: ").concat(n,".")),new Error("".concat(o+1,":").concat(s," is an undefined habitat: ").concat(n,"."));un(i,[[f,a]]),a=[]}else{var p=function(n){var e=n.match(cn);if(!e)return console.warn("看不懂："+n),null;if("蝌蚪"===e[1]||"卵"===e[1][0])return[{form:e[1]}];var t=Number(e[2]);if("抱接"===e[1])return[{form:"公",count:t,action:{id:5,name:"配對"}},{form:"母",count:t,action:{id:5,name:"配對"}}];var r=e[3];if(r){var i;if("#"===r[0]){var a=Number(r.substring(1))-1;i=an.find(function(n){return n[0]===a})}else i=an.find(function(n){return n[1].find(function(n){return n===r})});if(!i)return console.warn("找不到行為"),null;r={id:i[0],name:i[1][0]}}else r={id:8,name:"單獨"};return[{form:e[1],count:t,action:r}]}(n);p?ln(a,p):(e.push("".concat(o+1,":").concat(s," is an undefined data: ").concat(n)),console.warn("".concat(o+1,":").concat(s," is an undefined data: ").concat(n)))}s+=n.length+1})}else console.log("line ".concat(o+1," is an empty line."))}),i.length&&(sn(r,i,t),i=[],a=[]);var o={froglet:0,male:0,female:0,grown:0};return t.see=Object.assign({},o),t.hear=0,t.forEach(function(n){n.records.sort(function(n,e){return n[0].typeId-e[0].typeId||n[0].detailId-e[0].detailId});var e=Object.assign({},o),r=0;n.records.forEach(function(n){n[1].forEach(function(n){var t=n.form,i=n.count;switch(t){case"幼":e.froglet+=i;break;case"公":e.male+=i;break;case"母":e.female+=i;break;case"成":e.grown+=i;break;case"鳴":r+=i}})}),n.summary={see:e,hear:r},t.hear+=r,fn(t.see,e)}),console.log(t),t.sort(function(n,e){var t=n.species,r=e.species;return"".concat(t.family," ").concat(t.genus," ").concat(t.species).localeCompare("".concat(r.family," ").concat(r.genus," ").concat(r.species))})}$(function(){var n=$("#raw-text"),e=$("investigation-list")[0];$("button").click(function(t){t.preventDefault();var r=[],i=$("#counting-mode-1").is(":checked")?dn:pn;try{e.result=i($.trim(n.val()),r)}catch(t){console.warn(t),e.result=[]}finally{$("warning-toast")[0].input=r,r=[]}})})}});